#!/bin/bash
# Memory usage indicator for i3blocks

# Get memory info
MEMORY_INFO=$(free -h | awk 'NR==2{printf "%.1f/%.1fG", $3,$2}')
MEMORY_PERCENT=$(free | awk 'NR==2{printf "%.0f", $3*100/$2}')

# Color based on usage
if [[ $MEMORY_PERCENT -ge 90 ]]; then
    COLOR="#ff5555"  # Red for very high usage
elif [[ $MEMORY_PERCENT -ge 75 ]]; then
    COLOR="#ffb86c"  # Orange for high usage
elif [[ $MEMORY_PERCENT -ge 50 ]]; then
    COLOR="#f1fa8c"  # Yellow for medium usage
else
    COLOR="#50fa7b"  # Green for low usage
fi

# Click actions
case $BLOCK_BUTTON in
    1) foot -T float -w 800x600 -e btop ;;  # left click - open htop
    3) foot -T float -w 800x600 -e btop ;;  # right click - open htop
esac

# Output
echo "ðŸ’¾ $MEMORY_INFO|$MEMORY_PERCENT%"
echo "$MEMORY_PERCENT%"
echo "$COLOR"
